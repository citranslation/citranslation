{
 "children": [
  {
   "children": [{
    "children": [],
    "type": "build and test"
   }],
   "type": "name"
  },
  {
   "children": [{
    "children": [],
    "type": "workflow_call"
   }],
   "type": "on"
  },
  {
   "children": [
    {
     "children": [
      {
       "children": [{
        "children": [],
        "type": "ubuntu-latest"
       }],
       "type": "runs-on"
      },
      {
       "children": [
        {
         "children": [{
          "children": [{
           "children": [],
           "type": "actions/checkout@version"
          }],
          "type": "uses"
         }],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "build reahl-dev:latest docker-cmd"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "docker-cmd"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "extract built wheels"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "docker-cmd"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "upload built wheels to cache"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "actions/upload-artifact@version"
           }],
           "type": "uses"
          },
          {
           "children": [
            {
             "children": [{
              "children": [],
              "type": "wheels"
             }],
             "type": "name"
            },
            {
             "children": [{
              "children": [],
              "type": "/tmp/wheels"
             }],
             "type": "path"
            }
           ],
           "type": "with"
          }
         ],
         "type": "OBJ-NODE"
        }
       ],
       "type": "steps"
      }
     ],
     "type": "build"
    },
    {
     "children": [
      {
       "children": [{
        "children": [],
        "type": "build"
       }],
       "type": "needs"
      },
      {
       "children": [{
        "children": [],
        "type": "ubuntu-latest"
       }],
       "type": "runs-on"
      },
      {
       "children": [{
        "children": [{
         "children": [
          {
           "children": [],
           "type": "3.6"
          },
          {
           "children": [],
           "type": "3.7"
          },
          {
           "children": [],
           "type": "3.8"
          },
          {
           "children": [],
           "type": "3.9"
          },
          {
           "children": [],
           "type": "3.10"
          }
         ],
         "type": "python-version"
        }],
        "type": "matrix"
       }],
       "type": "strategy"
      },
      {
       "children": [{
        "children": [
         {
          "children": [{
           "children": [],
           "type": "postgres:12.3"
          }],
          "type": "image"
         },
         {
          "children": [
           {
            "children": [{
             "children": [],
             "type": "reahl"
            }],
            "type": "postgres_password"
           },
           {
            "children": [{
             "children": [],
             "type": "runner"
            }],
            "type": "postgres_user"
           }
          ],
          "type": "env"
         },
         {
          "children": [{
           "children": [],
           "type": "5432:5432"
          }],
          "type": "ports"
         },
         {
          "children": [{
           "children": [],
           "type": "--health-cmd pg_isready --health-interval 10s --health-timeout 5s --health-retries 5"
          }],
          "type": "options"
         }
        ],
        "type": "postgres"
       }],
       "type": "services"
      },
      {
       "children": [
        {
         "children": [{
          "children": [{
           "children": [],
           "type": "actions/checkout@version"
          }],
          "type": "uses"
         }],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "actions/setup-python@version"
           }],
           "type": "uses"
          },
          {
           "children": [{
            "children": [{
             "children": [],
             "type": "${{ matrix.python-version }}"
            }],
            "type": "python-version"
           }],
           "type": "with"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "install dependencies"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "python-cmd"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "download wheels"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "actions/download-artifact@version"
           }],
           "type": "uses"
          },
          {
           "children": [
            {
             "children": [{
              "children": [],
              "type": "wheels"
             }],
             "type": "name"
            },
            {
             "children": [{
              "children": [],
              "type": "~/.reahlworkspace/dist-egg"
             }],
             "type": "path"
            }
           ],
           "type": "with"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "map postgres machine name to localhost ip"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "sudo bash -c \\\"echo-cmd"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "prepare for-cmd"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "mkdir-cmd"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "setup test env"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "sudo apt-cmd"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "version of git"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "git --version"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "version of firefox"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "firefox --version"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "which firefox"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "which firefox"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "version of geckodriver"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "geckodriver --version"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "which geckodriver"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "which geckodriver"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "version of gpg"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "gpg --version"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "show path"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "echo-cmd"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "install reahl-dev"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": "pip install --pre reahl-dev reahl-commands reahl-postgresqlsupport"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "select all reahl projects"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": ". ~/.profile && reahl refresh && reahl select -a"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "create db user for-cmd"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": ". ~/.profile && reahl createdbuser -u runner travis/etc"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        },
        {
         "children": [
          {
           "children": [{
            "children": [],
            "type": "run tests"
           }],
           "type": "name"
          },
          {
           "children": [{
            "children": [],
            "type": ". ~/.profile && reahl shell -sdxg tox"
           }],
           "type": "run"
          }
         ],
         "type": "OBJ-NODE"
        }
       ],
       "type": "steps"
      }
     ],
     "type": "test"
    }
   ],
   "type": "build"
  }
 ],
 "type": "github-file"
}